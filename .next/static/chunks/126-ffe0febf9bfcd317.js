"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[126],{121:function(e,t,r){r.d(t,{default:function(){return c}});var a=r(7437),n=r(115),s=r(9376),i=r(2265),o=r(6478);function u(){return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,a.jsx)(o.E.div,{className:"w-12 h-12 border-4 border-primary/20 border-t-primary rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})})}function c(e){let{children:t,fallback:r}=e,{user:o,loading:c}=(0,n.aC)(),d=(0,s.useRouter)();return((0,i.useEffect)(()=>{c||o||d.push("/auth")},[o,c,d]),c||!o)?r||(0,a.jsx)(u,{}):(0,a.jsx)(a.Fragment,{children:t})}},2946:function(e,t,r){r.d(t,{default:function(){return f}});var a=r(7437),n=r(6478),s=r(2869),i=r(2660),o=r(8293),u=r(8728),c=r(7692),d=r(9376),l=r(115);function f(e){let{title:t,showBack:r,actions:f,onMenuClick:p}=e,h=(0,d.useRouter)(),{signOut:m,user:g}=(0,l.aC)();return(0,a.jsx)(n.E.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"sticky top-0 z-40 bg-background/80 backdrop-blur-sm border-b border-border",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 h-16 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[r&&(0,a.jsx)(s.z,{variant:"ghost",size:"sm",onClick:()=>h.back(),className:"p-2",children:(0,a.jsx)(i.Z,{className:"h-5 w-5"})}),p&&(0,a.jsx)(s.z,{variant:"ghost",size:"sm",onClick:p,className:"p-2",children:(0,a.jsx)(o.Z,{className:"h-5 w-5"})}),t&&(0,a.jsx)("h1",{className:"text-xl font-semibold text-foreground truncate",children:t})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[f,(0,a.jsx)(s.z,{variant:"ghost",size:"sm",onClick:()=>h.push("/settings"),className:"p-2",children:(0,a.jsx)(u.Z,{className:"h-5 w-5"})}),g&&(0,a.jsxs)(s.z,{variant:"outline",size:"sm",onClick:()=>m(),className:"ml-2",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4 mr-1"})," Logout"]})]})]})})}},2869:function(e,t,r){r.d(t,{z:function(){return c}});var a=r(7437),n=r(2265),s=r(7495),i=r(535),o=r(4508);let u=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,t)=>{let{className:r,variant:n,size:i,asChild:c=!1,...d}=e,l=c?s.g7:"button";return(0,a.jsx)(l,{className:(0,o.cn)(u({variant:n,size:i,className:r})),ref:t,...d})});c.displayName="Button"},115:function(e,t,r){r.d(t,{Vo:function(){return A},aC:function(){return j},pL:function(){return k}});var a=r(2265),n=r(1466),s=r(4257);let i=async(e,t)=>(0,n.e5)(s.I8,e,t),o=async(e,t)=>(0,n.Xb)(s.I8,e,t),u=async()=>(0,n.w7)(s.I8),c=e=>(0,n.Aj)(s.I8,e);var d=r(5978);let l="users",f=e=>e.toDate().toISOString(),p=async e=>{let t=(0,d.JU)(s.db,l,e.uid),r=d.EK.now();await (0,d.pl)(t,{...e,createdAt:r,updatedAt:r})},h=async e=>{let t=(0,d.JU)(s.db,l,e),r=await (0,d.QT)(t);if(r.exists()){let e=r.data();return{...e,createdAt:f(e.createdAt),updatedAt:f(e.updatedAt)}}return null};var m=r(9376);let g=0,v=new Map,y=e=>{if(v.has(e))return;let t=setTimeout(()=>{v.delete(e),w({type:"REMOVE_TOAST",toastId:e})},1e6);v.set(e,t)},b=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?y(r):e.toasts.forEach(e=>{y(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},x=[],S={toasts:[]};function w(e){S=b(S,e),x.forEach(e=>{e(S)})}function _(e){let{...t}=e,r=(g=(g+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>w({type:"DISMISS_TOAST",toastId:r});return w({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||a()}}}),{id:r,dismiss:a,update:e=>w({type:"UPDATE_TOAST",toast:{...e,id:r}})}}let A=(0,a.createContext)(void 0),j=()=>{let e=(0,a.useContext)(A);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},k=()=>{let[e,t]=(0,a.useState)(null),[r,n]=(0,a.useState)(!0),{toast:s}=function(){let[e,t]=a.useState(S);return a.useEffect(()=>(x.push(t),()=>{let e=x.indexOf(t);e>-1&&x.splice(e,1)}),[e]),{...e,toast:_,dismiss:e=>w({type:"DISMISS_TOAST",toastId:e})}}(),d=(0,m.useRouter)();return(0,a.useEffect)(()=>{let e=c(async e=>{if(e)try{let r=await h(e.uid);if(!r){let t={uid:e.uid,email:e.email||"",name:e.displayName||"User",streak:0,lastLoggedDate:null,xpLevel:1};await p(t),r={...t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}t(r)}catch(e){console.error("Error fetching user data:",e),s({title:"Error",description:"Failed to load user data",variant:"destructive"})}else t(null);n(!1)});return()=>e()},[s]),{user:e,loading:r,signIn:async(e,t)=>{try{n(!0),await i(e,t),s({title:"Welcome back!",description:"Successfully signed in"}),d.push("/dashboard")}catch(e){throw s({title:"Sign in failed",description:e.message,variant:"destructive"}),e}finally{n(!1)}},signUp:async(e,t,r)=>{try{n(!0);let a={uid:(await o(e,t)).user.uid,email:e,name:r,streak:0,lastLoggedDate:null,xpLevel:1};await p(a),s({title:"Account created!",description:"Welcome to FitTrack"}),d.push("/dashboard")}catch(e){throw s({title:"Sign up failed",description:e.message,variant:"destructive"}),e}finally{n(!1)}},signOut:async()=>{try{await u(),t(null),s({title:"Signed out",description:"See you next time!"}),d.push("/auth")}catch(e){throw s({title:"Sign out failed",description:e.message,variant:"destructive"}),e}}}}},4257:function(e,t,r){r.d(t,{I8:function(){return o},db:function(){return u}});var a=r(738),n=r(1466),s=r(5978);let i=(0,a.ZF)({apiKey:"your_api_key",authDomain:"your_auth_domain",projectId:"your_project_id",storageBucket:"your_storage_bucket",messagingSenderId:"your_sender_id",appId:"your_app_id"}),o=(0,n.v0)(i),u=(0,s.ad)(i)},4508:function(e,t,r){r.d(t,{cn:function(){return s}});var a=r(1994),n=r(3335);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,a.W)(t))}}}]);