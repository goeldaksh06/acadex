(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{3615:function(t,e,a){Promise.resolve().then(a.bind(a,1137)),Promise.resolve().then(a.t.bind(a,911,23)),Promise.resolve().then(a.t.bind(a,7960,23))},1137:function(t,e,a){"use strict";a.d(e,{default:function(){return i}});var n=a(7437),r=a(115);function i(t){let{children:e}=t,a=(0,r.pL)();return(0,n.jsx)(r.Vo.Provider,{value:a,children:e})}},115:function(t,e,a){"use strict";a.d(e,{Vo:function(){return w},aC:function(){return E},pL:function(){return O}});var n=a(2265),r=a(1466),i=a(4257);let s=async(t,e)=>(0,r.e5)(i.I8,t,e),o=async(t,e)=>(0,r.Xb)(i.I8,t,e),u=async()=>(0,r.w7)(i.I8),c=t=>(0,r.Aj)(i.I8,t);var d=a(5978);let l="users",p=t=>t.toDate().toISOString(),f=async t=>{let e=(0,d.JU)(i.db,l,t.uid),a=d.EK.now();await (0,d.pl)(e,{...t,createdAt:a,updatedAt:a})},_=async t=>{let e=(0,d.JU)(i.db,l,t),a=await (0,d.QT)(e);if(a.exists()){let t=a.data();return{...t,createdAt:p(t.createdAt),updatedAt:p(t.updatedAt)}}return null};var S=a(9376);let y=0,h=new Map,m=t=>{if(h.has(t))return;let e=setTimeout(()=>{h.delete(t),I({type:"REMOVE_TOAST",toastId:t})},1e6);h.set(t,e)},A=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,1)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{let{toastId:a}=e;return a?m(a):t.toasts.forEach(t=>{m(t.id)}),{...t,toasts:t.toasts.map(t=>t.id===a||void 0===a?{...t,open:!1}:t)}}case"REMOVE_TOAST":if(void 0===e.toastId)return{...t,toasts:[]};return{...t,toasts:t.toasts.filter(t=>t.id!==e.toastId)}}},v=[],g={toasts:[]};function I(t){g=A(g,t),v.forEach(t=>{t(g)})}function T(t){let{...e}=t,a=(y=(y+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>I({type:"DISMISS_TOAST",toastId:a});return I({type:"ADD_TOAST",toast:{...e,id:a,open:!0,onOpenChange:t=>{t||n()}}}),{id:a,dismiss:n,update:t=>I({type:"UPDATE_TOAST",toast:{...t,id:a}})}}let w=(0,n.createContext)(void 0),E=()=>{let t=(0,n.useContext)(w);if(void 0===t)throw Error("useAuth must be used within an AuthProvider");return t},O=()=>{let[t,e]=(0,n.useState)(null),[a,r]=(0,n.useState)(!0),{toast:i}=function(){let[t,e]=n.useState(g);return n.useEffect(()=>(v.push(e),()=>{let t=v.indexOf(e);t>-1&&v.splice(t,1)}),[t]),{...t,toast:T,dismiss:t=>I({type:"DISMISS_TOAST",toastId:t})}}(),d=(0,S.useRouter)();return(0,n.useEffect)(()=>{let t=c(async t=>{if(t)try{let a=await _(t.uid);if(!a){let e={uid:t.uid,email:t.email||"",name:t.displayName||"User",streak:0,lastLoggedDate:null,xpLevel:1};await f(e),a={...e,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}e(a)}catch(t){console.error("Error fetching user data:",t),i({title:"Error",description:"Failed to load user data",variant:"destructive"})}else e(null);r(!1)});return()=>t()},[i]),{user:t,loading:a,signIn:async(t,e)=>{try{r(!0),await s(t,e),i({title:"Welcome back!",description:"Successfully signed in"}),d.push("/dashboard")}catch(t){throw i({title:"Sign in failed",description:t.message,variant:"destructive"}),t}finally{r(!1)}},signUp:async(t,e,a)=>{try{r(!0);let n={uid:(await o(t,e)).user.uid,email:t,name:a,streak:0,lastLoggedDate:null,xpLevel:1};await f(n),i({title:"Account created!",description:"Welcome to FitTrack"}),d.push("/dashboard")}catch(t){throw i({title:"Sign up failed",description:t.message,variant:"destructive"}),t}finally{r(!1)}},signOut:async()=>{try{await u(),e(null),i({title:"Signed out",description:"See you next time!"}),d.push("/auth")}catch(t){throw i({title:"Sign out failed",description:t.message,variant:"destructive"}),t}}}}},4257:function(t,e,a){"use strict";a.d(e,{I8:function(){return o},db:function(){return u}});var n=a(738),r=a(1466),i=a(5978);let s=(0,n.ZF)({apiKey:"your_api_key",authDomain:"your_auth_domain",projectId:"your_project_id",storageBucket:"your_storage_bucket",messagingSenderId:"your_sender_id",appId:"your_app_id"}),o=(0,r.v0)(s),u=(0,i.ad)(s)},7960:function(){},911:function(t){t.exports={style:{fontFamily:"'__Inter_e8ce0c', '__Inter_Fallback_e8ce0c'",fontStyle:"normal"},className:"__className_e8ce0c"}}},function(t){t.O(0,[944,609,210,361,971,117,744],function(){return t(t.s=3615)}),_N_E=t.O()}]);