(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{9913:function(t,e,a){Promise.resolve().then(a.bind(a,1137)),Promise.resolve().then(a.t.bind(a,4742,23)),Promise.resolve().then(a.t.bind(a,7960,23))},1137:function(t,e,a){"use strict";a.d(e,{default:function(){return s}});var i=a(7437),n=a(115);function s(t){let{children:e}=t,a=(0,n.pL)();return(0,i.jsx)(n.Vo.Provider,{value:a,children:e})}},115:function(t,e,a){"use strict";a.d(e,{Vo:function(){return w},aC:function(){return b},pL:function(){return E}});var i=a(2265),n=a(1466),s=a(4257);let r=async(t,e)=>(0,n.e5)(s.I8,t,e),o=async(t,e)=>(0,n.Xb)(s.I8,t,e),u=async()=>(0,n.w7)(s.I8),c=t=>(0,n.Aj)(s.I8,t);var d=a(5978);let l="users",f=t=>t.toDate().toISOString(),p=async t=>{let e=(0,d.JU)(s.db,l,t.uid),a=d.EK.now();await (0,d.pl)(e,{...t,createdAt:a,updatedAt:a})},S=async t=>{let e=(0,d.JU)(s.db,l,t),a=await (0,d.QT)(e);if(a.exists()){let t=a.data();return{...t,createdAt:f(t.createdAt),updatedAt:f(t.updatedAt)}}return null};var h=a(9376);let m=0,y=new Map,A=t=>{if(y.has(t))return;let e=setTimeout(()=>{y.delete(t),g({type:"REMOVE_TOAST",toastId:t})},1e6);y.set(t,e)},v=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,1)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{let{toastId:a}=e;return a?A(a):t.toasts.forEach(t=>{A(t.id)}),{...t,toasts:t.toasts.map(t=>t.id===a||void 0===a?{...t,open:!1}:t)}}case"REMOVE_TOAST":if(void 0===e.toastId)return{...t,toasts:[]};return{...t,toasts:t.toasts.filter(t=>t.id!==e.toastId)}}},I=[],_={toasts:[]};function g(t){_=v(_,t),I.forEach(t=>{t(_)})}function T(t){let{...e}=t,a=(m=(m+1)%Number.MAX_SAFE_INTEGER).toString(),i=()=>g({type:"DISMISS_TOAST",toastId:a});return g({type:"ADD_TOAST",toast:{...e,id:a,open:!0,onOpenChange:t=>{t||i()}}}),{id:a,dismiss:i,update:t=>g({type:"UPDATE_TOAST",toast:{...t,id:a}})}}let w=(0,i.createContext)(void 0),b=()=>{let t=(0,i.useContext)(w);if(void 0===t)throw Error("useAuth must be used within an AuthProvider");return t},E=()=>{let[t,e]=(0,i.useState)(null),[a,n]=(0,i.useState)(!0),{toast:s}=function(){let[t,e]=i.useState(_);return i.useEffect(()=>(I.push(e),()=>{let t=I.indexOf(e);t>-1&&I.splice(t,1)}),[t]),{...t,toast:T,dismiss:t=>g({type:"DISMISS_TOAST",toastId:t})}}(),d=(0,h.useRouter)();return(0,i.useEffect)(()=>{let t=c(async t=>{if(t)try{let a=await S(t.uid);if(!a){let e={uid:t.uid,email:t.email||"",name:t.displayName||"User",streak:0,lastLoggedDate:null,xpLevel:1};await p(e),a={...e,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}e(a)}catch(t){console.error("Error fetching user data:",t),s({title:"Error",description:"Failed to load user data",variant:"destructive"})}else e(null);n(!1)});return()=>t()},[s]),{user:t,loading:a,signIn:async(t,e)=>{try{n(!0),await r(t,e),s({title:"Welcome back!",description:"Successfully signed in"}),d.push("/dashboard")}catch(t){throw s({title:"Sign in failed",description:t.message,variant:"destructive"}),t}finally{n(!1)}},signUp:async(t,e,a)=>{try{n(!0);let i={uid:(await o(t,e)).user.uid,email:t,name:a,streak:0,lastLoggedDate:null,xpLevel:1};await p(i),s({title:"Account created!",description:"Welcome to FitTrack"}),d.push("/dashboard")}catch(t){throw s({title:"Sign up failed",description:t.message,variant:"destructive"}),t}finally{n(!1)}},signOut:async()=>{try{await u(),e(null),s({title:"Signed out",description:"See you next time!"}),d.push("/auth")}catch(t){throw s({title:"Sign out failed",description:t.message,variant:"destructive"}),t}}}}},4257:function(t,e,a){"use strict";a.d(e,{I8:function(){return o},db:function(){return u}});var i=a(738),n=a(1466),s=a(5978);let r=(0,i.ZF)({apiKey:"AIzaSyBGi002vjHm9VJbXDOio6ARdmIM5smhHUM",authDomain:"fittrack-1d442.firebaseapp.com",projectId:"fittrack-1d442",storageBucket:"fittrack-1d442.firebasestorage.app",messagingSenderId:"668676349404",appId:"1:668676349404:web:07690b59d36d7716c4c319"}),o=(0,n.v0)(r),u=(0,s.ad)(r)},7960:function(){},4742:function(t){t.exports={style:{fontFamily:"'__Inter_e8ce0c', '__Inter_Fallback_e8ce0c'",fontStyle:"normal"},className:"__className_e8ce0c"}}},function(t){t.O(0,[540,609,210,361,971,117,744],function(){return t(t.s=9913)}),_N_E=t.O()}]);